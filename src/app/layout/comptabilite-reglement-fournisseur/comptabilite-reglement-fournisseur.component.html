<br>
<br>

<div class="row"  >
    
  <div class="col-md-12" >
                   
                            <div class="row">
                                <div class="col-md-1">Début :</div>
                                <div class="col-md-2">
                                    <p-calendar 
                                    [locale]="tn"
                                    [(ngModel)]="datedebut"
                                    [yearNavigator]="true"
                                    [monthNavigator]="true"
                                    yearRange="2017:2999"
                                    dateFormat="dd/mm/yy "    
                                    
                                    > 
                                  </p-calendar>

                                  
                                </div>
                                <div class="col-md-1">Fin :</div>
                                <div class="col-md-2">
                                    <p-calendar 
                                    [locale]="tn"
                                    [(ngModel)]="datefin"
                                    [yearNavigator]="true"
                                    [monthNavigator]="true"
                                    yearRange="2017:2999"
                                    dateFormat="dd/mm/yy "    
                                    
                                    > 
                                  </p-calendar>

                                  
                                </div>
                                <div class="col-md-1">fournisseur:</div>
                                
                                <div class="col-md-3" 
                                                             >   <ng-select  
                                  ngselect
                                  id="frns" 
                                  [items]="fournisseurs"                              
                                  bindLabel="deno"                        
                                  placeholder="Nom fournisseur"
                                  [(ngModel)]="selectedFournisseur"
                                  [disabled]="readonl"
                                  [searchFn]="onSearchFournisseur"
                                  (change)="changeFournisseur()"
                                  style="width: 100%;">
                              </ng-select>
                            </div>  
                            <div class="col-md-1" *ngIf="this.visibleBtnAfficher"> <p-button class="center"  (click)="init()" id="init" label="initialiser" styleClass="ui-button-info" ></p-button>
                            </div>
                            <div class="col-md-1" *ngIf="this.visibleBtnAfficher"> <p-button class="center"  (click)="afficher($event)" id="aff" label="afficher" styleClass="ui-button-info" ></p-button>
                            </div>                  
                         </div>
                   
</div>
</div>
<br>
<div class="row"  >
    
  <div class="col-md-12" >
                   
                            <div class="row">
                                <div class="col-md-1"></div>
                                <div class="col-md-2">
                                </div>
                                <div class="col-md-1"></div>
                                <div class="col-md-2">
                                </div>
                                <div class="col-md-1"> Code :</div>
                                
                                <div class="col-md-3"  >   <ng-select 
                                  ngselect
                                  id="frns" 
                                  style="width: 100%;"
                                  [items]="fournisseurs"                              
                                  bindLabel="code"                        
                                  placeholder="Code fournisseur"
                                  [(ngModel)]="selectedFournisseur"
                                  [disabled]="readonl"
                                  [searchFn]="onSearchFournisseurParCode"
                                  (change)="changeFournisseur()">
                              </ng-select>
                            </div>  
                            <div class="col-md-1" > 
                            </div>
                            <div class="col-md-1" > 
                            </div>                  
                         </div>
                   
</div>
</div>
<br>
<div *ngIf="btnafficher">






<div class="row"  >
    
  <div class="col-md-12" >
                    
                        <div class="row">
                        <div class="col-md-12">
                            
                            <p-table #dt    [value]="liste"  dataKey="id" [resizableColumns]="true"
 


                            selectionMode="single"  
                            [responsive]="true" [scrollable]="true" scrollHeight="24.95em" 


                                 
                                  
                            editMode="row" 
                            >
                                <ng-template pTemplate="header">
                                  <tr >
                                    <th style="width: 6%; ">N° Facture</th>
                                    <th style="width: 11%;">date</th>
                                    <th style="width: 11%;">Echéance</th>
                                    <th style="width: 9%;">Banque</th>
                                    <th style="width: 8%;">Mnt en devise</th>

                                    <th style="width: 6%;">Devise</th>
                                    
                                    <th style="width: 9%;">Montant en DT</th>
                                    <th style="width: 3%;">Regle</th>
                                    <th style="width: 3%;">Recu</th>
                                    <th style="width: 11%;">Date reg</th>
                                    <th style="width: 6%;">Edit</th>
                                    </tr>
                                </ng-template>
                                <ng-template pTemplate="body" let-rowData  let-editing="editing" let-ri="rowIndex"
                               
                                >
                                 
                                    <tr  style="height:30px"
                                  
                                    #row [attr.id]="rowData.id"
                                    [pEditableRow]="rowData"
                                        >

                                        <td  style="width: 6%;   " id="row_{{rowData.id}}_num"  >
                                          <p-cellEditor >
                                            <ng-template pTemplate="input" style="position: center;" >
                                              <input
                                              [readOnly]="readonly"
                                              pInputText
                                              type="search"
                                              style="width: 100%;"
                                              [minLength]="1"
                                              size="10"
                                            
                                              [autofocus]="true"
                                              [(ngModel)]="rowData.numero"
                                              [maxLength]="10"
                                               [readOnly]="readonly"
                                               
                                               class="form-control"
                                              />
                                            </ng-template>
                                             <ng-template pTemplate="output">
                                              {{rowData.numero}}
                                            
                                            </ng-template>
                                        </p-cellEditor>
                                           
                                        </td>
                                        <td style="width: 11%;   "> 
                                            <p-cellEditor >
                                                <ng-template pTemplate="input" style="position: center; font-size: 12px;" >
                                                  <p-calendar
                                                  appendTo="body"
                                                  [locale]="tn"
                                                  
                                                  [(ngModel)]="rowData.date"
                                                  placeholder="date du facture"
                                                  [yearNavigator]="true"
                                                  yearRange="1990:2999"
                                                  [monthNavigator]="true"
                                                  dateFormat="dd/mm/yy "    
                                                  id='date'
                                                  [disabled]="readonlyy"
                                                 
                                                  
                                                  > 
                                                 </p-calendar>
                                                   
                                                </ng-template>
                                                 <ng-template pTemplate="output">
                                                    {{rowData.date | date : 'dd/MM/y'}}
                                                </ng-template>
                                            </p-cellEditor>
                                        </td>
                                        <td style="width: 11%;   ">
                                            <p-cellEditor>
                                                <ng-template pTemplate="input">
                                                  
                                                  <p-calendar 
                                                  id="dateEch"
                                                  
                                                  appendTo="body"
                                                  [locale]="tn"
                                                  [(ngModel)]="rowData.echeance"
                                                  placeholder="date d'échéance"
                                                  [yearNavigator]="true"
                                                  yearRange="1990:2999"
                                                  [monthNavigator]="true"
                                                  dateFormat="dd/mm/yy "    
                                                  
                                                  [disabled]="readonly1"
                                                  
                                                  > 
                                                 </p-calendar>
                                                    
                                                </ng-template>
                                                <ng-template pTemplate="output">
                                                    {{rowData.echeance | date : 'dd/MM/y'}}
                                                </ng-template>
                                            </p-cellEditor>
                                        </td>
                                        <td style="width: 9%;   ">
                                            <p-cellEditor>
                                                <ng-template pTemplate="input" style="size: 10px;">
                                                  
                                                   <ng-select
                                                   appendTo="body"
                                                   ngselect
                                                   id="row_{{rowData.id}}_bnq"
                                                   id="bnq" 
                                                   [items]="banques"                              
                                                   bindLabel="deno" 
                                                   bindValue="deno"
                                                   (change)="changeBanque(rowData.banque)"                       
                                                   placeholder="banque"
                                                   [(ngModel)]="rowData.banque"
                                                  [disabled]="readonly1"
                                                   >
                                               </ng-select>
                                                </ng-template>
                                              
                                                <ng-template  appendTo="body" pTemplate="output">
                                                   {{rowData.banque}}
                                              </ng-template>
                                            </p-cellEditor>
                                        </td>
                                        <td style="width: 8%;   ">
                                            <p-cellEditor>
                                              <ng-template pTemplate="input">
                                                 
                                                  <input
                                                  pInputText
                                                  type="search"
                                                  style="width: 100%;"
                                                  [min]="1"
                                                 
                                                  placeholder="Mnt en devise"
                                                  pKeyFilter="num"
                                                  [(ngModel)]="rowData.montant"
                                                  [maxLength]="10"
                                                 [readOnly]="readonly1"
                                                 
                                                />
                                              </ng-template>
                                              <ng-template pTemplate="output" >
                                                <p class="pRight" align="right"> {{rowData.montant}}</p>
                                              </ng-template>
                                          </p-cellEditor>
                                        </td>
                                        <td style="width: 6%;     ">
                                          <p-cellEditor>
                                            <ng-template pTemplate="input">
                                                <input pInputText style="width: 100%;"
                                                 
                                                  appendTo="body"
                                                 [maxLength]="3"
                                                 [minLength]="3" 
                                                  width="100%"
                                                  placeholder="dvise"
                                                  pKeyFilter="alpha"
                                                 type="search" 
                                                 [readOnly]="readonly1"
                                                 [(ngModel)]="rowData.devise">
                                            </ng-template>
                                            <ng-template pTemplate="output">
                                                {{rowData.devise}}
                                            </ng-template>
                                        </p-cellEditor>
                                        </td>
                                        <td style="width: 9%;     ">
                                        <p-cellEditor>
                                          <ng-template pTemplate="input">
                                              <input pInputText
                                                size="12"
                                                  appendTo="body"
                                                  pKeyFilter="num"
                                                   type="search" 
                                                   placeholder="Net"
                                                   [readOnly]="readonly1"
                                                   id="row_{{rowData.id}}_net"
                                                   [(ngModel)]="rowData.net">
                                          </ng-template>
                                          <ng-template pTemplate="output" >
                                             <p class="pRight" align="right">{{rowData.net}}</p> 
                                          </ng-template>
                                      </p-cellEditor>
                                    </td>
                                    <td style="width: 3%;   ">
                                      <p-cellEditor>
                                        <ng-template pTemplate="input">
                                          <p-checkbox [disabled]="readonly1" appendTo="body" name="groupname"  [value]="'O'" (onChange)="changeRegle()" [(ngModel)]="this.regle"></p-checkbox>
                                           
                                        </ng-template>
                                        <ng-template pTemplate="output">
                                            {{rowData.regle}}
                                        </ng-template>
                                    </p-cellEditor>
                                </td>
                                 <td style="width: 3%;   ">
                                    <p-cellEditor>

                                      <ng-template pTemplate="input">
                                        {{rowData.recu}}
                                         
                                      </ng-template>
                                      <ng-template pTemplate="output" style="width: 2%;">
                                          {{rowData.recu}} 
                                      </ng-template>
                                  </p-cellEditor>
                                </td>
                            <td style="width: 11%;   ">
                                  <p-cellEditor>
                                    <ng-template pTemplate="input">
                                      <p-calendar 
                                      appendTo="body"
                                      [locale]="tn"
                                      id="row_{{rowData.id}}_dat_regl"
                                      [(ngModel)]="rowData.dat_regl"
                                      placeholder="date reglement"
                                      yearRange="1990:2999"
                                      [yearNavigator]="true"
                                      [monthNavigator]="true"
                                      dateFormat="dd/mm/yy "    
                                      [disabled]="readonly1"
                                     
                                      > 
                                     </p-calendar>

                                       
                                    </ng-template>
                                    <ng-template pTemplate="output">
                                        {{rowData.dat_regl | date : 'dd/MM/y'}}
                                    </ng-template>
                                </p-cellEditor>
                            </td>  
                            <td style="position: center; width: 6%;   ">
                             
                                            <button *ngIf="!editing" pButton type="button" pInitEditableRow icon="pi pi-pencil" class="ui-button-info" [disabled]="disable" (click)="onRowEditInit(rowData)" ></button>
                                            <button *ngIf="editing && readonly1 === false " pButton type="button" pSaveEditableRow icon="pi pi-check" class="ui-button-success"  id="sav" style="margin-right: .5em" (click)="onRowEditSave(rowData,$event)"></button>
                                            <button *ngIf="editing" pButton type="button" pCancelEditableRow icon="pi pi-times" class="ui-button-danger" (click)="onRowEditCancel(rowData, ri)"></button>
                           
                                            
                                              <button *ngIf="!editing" 
                                                pButton
                                                type="button"
                                                pDeletetableRow
                                                icon="pi pi-trash"
                                                class="ui-button-danger"
                                                (click)="supprimer(ri)"
                                                [disabled]="disable"
                                              ></button>
                                            
                           
                                          </td>
                                    </tr>
                                </ng-template>
                            </p-table>
                            
                          
                              </div>

                              </div>

                             
                    
</div>
</div>
<br>
<div class="row">
  <div class="col-md-2" ><p-button class="center" [hidden]="!btnNouvelleSaise"  (click)="nouvelleSaisie()"label="Nouvelle saisie" styleClass="ui-button-info" ></p-button></div>
  <div class="col-md-3"></div>
  <div class="col-md-1" ><p-button class="center" [hidden]="!appercu" (click)="apercu()"label="Aperçu" styleClass="ui-button-info" ></p-button></div>
  <div class="col-md-5"></div>
 
    <div class="col-md-1" ><button  [hidden]="!btnajut" pButton type="button"icon="pi pi-plus"  class="ui-button-info" [label]="'Ajouter'"
      pAddRow [table]="dt" [newRow]="newRow()"  ></button></div> 
  </div>







<br>

</div>



<p-overlayPanel [dismissable]="false"  #op appendTo="body" [showCloseIcon]="true" [style]="{'text-align': 'center','font-size':'14px' ,'background-color': '#f8b7bd'}" >
  <span>{{ msgerror}}  </span> 
</p-overlayPanel>



<p-confirmDialog [style]="{width: '50vw'}"></p-confirmDialog>



