
<p-blockUI [blocked]="blocked"></p-blockUI>
<br> <br>
<div class="row"  >
    
  <div class="col-md-12" >
                    
                            <div class="row">
                                
                                <div class="col-md-2">
                                  Du :
                                    <p-calendar 
                                    [locale]="tn"
                                    [(ngModel)]="datedebut"
                                    [yearNavigator]="true"
                                    [monthNavigator]="true"
                                    yearRange="2017:2999"
                                    dateFormat="dd/mm/yy "    
                                    
                                    > 
                                  </p-calendar>

                                  
                                </div>
                               
                                <div class="col-md-2">
                                  Au :
                                    <p-calendar 
                                    [locale]="tn"
                                    [(ngModel)]="datefin"
                                    [yearNavigator]="true"
                                    [monthNavigator]="true"
                                    yearRange="2017:2999"
                                    dateFormat="dd/mm/yy "    
                                    
                                    > 
                                  </p-calendar>

                                  
                                </div>
                                <div class="col-md-1">Fournisseur:</div>
                                <div class="col-md-1">  {{codeFour}}  </div>
                                <div class="col-md-2">   <ng-select
                                  ngselect
                                  id="frns" 
                                  [items]="fournisseurs"                              
                                  bindLabel="deno"                        
                                  placeholder="choisir un fournisseur"
                                  [(ngModel)]="selectedFournisseur"
                                  [disabled]="readonl"
                                  (change)="changeFournisseur()">
                              </ng-select>
                            </div> 
                            <div class="col-md-1" *ngIf="this.visibleBtnAfficher"> <p-button class="center"  (click)="init()" id="init" label="initialiser" styleClass="ui-button-info" ></p-button>
                            </div>  
                            <div class="col-md-1" *ngIf="this.visibleBtnAfficher"> <p-button class="center"  (click)="afficher($event)" id="affich" label="afficher" styleClass="ui-button-info" ></p-button>
                            </div>                  
                         </div>
                    
</div>
</div>
<br>
<div *ngIf="btnafficher">





<!--id="row_{{ rowData.id }}" #dt  dt -->

<div class="row"  >
    
  <div class="col-md-12" >
                    
                        <div class="row">
                        <div class="col-md-12">
                            
                            <p-table #dt  class="flexcolumn"  [value]="liste"  dataKey="id" [resizableColumns]="true"

                                   [responsive]="false" [scrollable]="true" scrollHeight="24.5em" 
                                     
                            editMode="row" 
                            >
                                <ng-template pTemplate="header">
                                  <tr >
                                    <th style="width: 7%;">N° Facture</th>
                                    <th style="width: 8%;">date</th>
                                    <th style="width: 8%;">Echéance</th>
                                    <th style="width: 10%;">Banque</th>
                                    <th style="width: 9%;">Mnt en devise</th>

                                    <th style="width: 6%;">Devise</th>
                                    
                                    <th style="width: 9%;">Montant en DT</th>
                                    <th style="width: 3%;">Regle</th>
                                    <th style="width: 4%;">Recu</th>
                                    <th style="width: 8%;">Date reg</th>
                                    <th style="width: 6%;">Edit</th>
                                    </tr>
                                </ng-template>
                                <ng-template pTemplate="body" let-rowData  let-editing="editing" let-ri="rowIndex"
                               
                                >
                                 
                                    <tr 
                                  
                                    #row [attr.id]="rowData.id"
                                    [pEditableRow]="rowData"
                                        >

                                        <td  style="width: 7%;" id="row_{{rowData.id}}_num"  >
                                          <p-cellEditor >
                                            <ng-template pTemplate="input" style="position: center;" >
                                              {{rowData.numero}}
                                             <!----<input
                                              
                                              pInputText
                                              type="search"
                                              style="width: 100%;"
                                              [min]="1"
                                             
                                              pKeyFilter="num"
                                              [autofocus]="true"
                                              [(ngModel)]="rowData.numero"
                                              [maxLength]="20"
                                               [readOnly]="readonly"
                                               
                                               class="form-control"
                                              />-->
                                            </ng-template>
                                             <ng-template pTemplate="output">
                                              {{rowData.numero}}
                                            
                                            </ng-template>
                                        </p-cellEditor>
                                           
                                        </td>
                                        <td style="width: 8%;"> 
                                            <p-cellEditor >
                                                <ng-template pTemplate="input" style="position: center;" >
                                                  {{rowData.date | date : 'dd/MM/y'}}
                                                  <!--<p-calendar 
                                                  appendTo="body"
                                                  [locale]="tn"
                                                  [(ngModel)]="rowData.date"
                                                  placeholder="date du facture"
                                                  [yearNavigator]="true"
                                                  yearRange="1990:2999"
                                                  [monthNavigator]="true"
                                                  dateFormat="dd/mm/yy "    
                                                  id='date'
                                                  [disabled]="readonly"
                                                  
                                                  > 
                                                 </p-calendar>-->
                                                   
                                                </ng-template>
                                                 <ng-template pTemplate="output">
                                                    {{rowData.date | date : 'dd/MM/y'}}
                                                </ng-template>
                                            </p-cellEditor>
                                        </td>
                                        <td style="width: 8%;">
                                            <p-cellEditor>
                                                <ng-template pTemplate="input">
                                                  {{rowData.echeance | date : 'dd/MM/y'}}
                                                  
                                                  <!--<p-calendar 
                                                  id="dateEch"
                                                  appendTo="body"
                                                  [locale]="tn"
                                                  [(ngModel)]="rowData.echeance"
                                                  placeholder="date d'échéance"
                                                  [yearNavigator]="true"
                                                  yearRange="1990:2999"
                                                  [monthNavigator]="true"
                                                  dateFormat="dd/mm/yy "    
                                                  [disabled]="readonly"
                                                  id='echeance'
                                                  
                                                  > 
                                                 </p-calendar> -->
                                                    
                                                </ng-template>
                                                <ng-template pTemplate="output">
                                                    {{rowData.echeance | date : 'dd/MM/y'}}
                                                </ng-template>
                                            </p-cellEditor>
                                        </td>
                                        <td style="width: 10%;">
                                            <p-cellEditor>
                                                <ng-template pTemplate="input" style="size: 10px;">
                                                  {{rowData.banque}}
                                                   <!--<ng-select
                                                   appendTo="body"
                                                   ngselect
                                                   id="row_{{rowData.id}}_bnq"
                                                   id="bnq" 
                                                   [items]="banques"                              
                                                   bindLabel="deno" 
                                                   bindValue="deno"                    
                                                   placeholder="choisir une banque"
                                                   [(ngModel)]="rowData.banque"
                                                   [disabled]="readonly"
                                                   >
                                                   </ng-select>-->
                                                </ng-template>
                                              
                                                <ng-template  appendTo="body" pTemplate="output">
                                                   {{rowData.banque}}
                                              </ng-template>
                                            </p-cellEditor>
                                        </td>
                                        <td style="width: 9%;">
                                            <p-cellEditor>
                                              <ng-template pTemplate="input">
                                                <p class="pRight" align="right"> {{rowData.montant}}</p>
                                                  <!--<input 
                                                  pInputText
                                                  type="search"
                                                  style="width: 100%;"
                                                  [min]="1"
                                                  
                                                  placeholder="Mnt en devise"
                                                  pKeyFilter="num"
                                                  [(ngModel)]="rowData.montant"
                                                  [maxLength]="20"
                                                  [readOnly]="readonly"
                                                 
                                                />-->
                                              </ng-template>
                                              <ng-template pTemplate="output" >
                                                <p class="pRight" align="right"> {{rowData.montant}}</p>
                                              </ng-template>
                                          </p-cellEditor>
                                        </td>
                                        <td style="width: 6%;">
                                          <p-cellEditor>
                                            <ng-template pTemplate="input">
                                              {{rowData.devise}}
                                                <!--<input pInputText
                                                 size="5"
                                                  appendTo="body"
                                                  [readOnly]="readonly"
                                                 [maxLength]="3"
                                                 [minLength]="3" 
                                                  placeholder="devise"
                                                  pKeyFilter="alpha"
                                                 type="search" 
                                                 [(ngModel)]="rowData.devise">-->
                                            </ng-template>
                                            <ng-template pTemplate="output">
                                                {{rowData.devise}}
                                            </ng-template>
                                        </p-cellEditor>
                                        </td>
                                        <td style="width: 9%;">
                                        <p-cellEditor>
                                          <ng-template pTemplate="input">
                                            <p class="pRight" align="right">{{rowData.net}}</p> 
                                             <!-- <input pInputText
                                              size="17"
                                                  appendTo="body"
                                                  pKeyFilter="num"
                                                   type="search" 
                                                   placeholder="Net"
                                                   [readOnly]="readonly"
                                                   id="row_{{rowData.id}}_net"
                                                   [(ngModel)]="rowData.net">-->
                                          </ng-template>
                                          <ng-template pTemplate="output" >
                                            <p class="pRight" align="right">{{rowData.net}}</p> 
                                          </ng-template>
                                      </p-cellEditor>
                                    </td>
                                    <td style="width: 3%;">
                                      <p-cellEditor>
                                        <ng-template pTemplate="input">
                                          {{rowData.regle}}
                                          <!--<p-checkbox [disabled]="readonly"  appendTo="body" name="groupname"  [value]="rowData.regle" (onChange)="changeRegle()" [(ngModel)]="regle"></p-checkbox>
                                          -->
                                        </ng-template>
                                        <ng-template pTemplate="output">
                                            {{rowData.regle}}
                                        </ng-template>
                                    </p-cellEditor>
                                </td>
                                 <td style="width: 4%;">
                                    <p-cellEditor>

                                      <ng-template pTemplate="input">
                                        <p-checkbox  [disabled]="readonlyy" appendTo="body" name="groupname"  [value]="true" (onChange)="changeRecu()" [(ngModel)]="recu"></p-checkbox>
                                         
                                      </ng-template>
                                      <ng-template pTemplate="output" style="width: 2%;">
                                          {{rowData.recu}}
                                      </ng-template>
                                  </p-cellEditor>
                                </td>
                            <td style="width: 8%;">
                                  <p-cellEditor>
                                    <ng-template pTemplate="input">
                                      {{rowData.dat_regl | date : 'dd/MM/y'}}
                                      <!--<p-calendar 
                                      appendTo="body"
                                      [locale]="tn"
                                      id="row_{{rowData.id}}_dat_regl"
                                      [(ngModel)]="rowData.dat_regl"
                                      placeholder="date reglement"
                                      yearRange="1990:2999"
                                      [yearNavigator]="true"
                                      [monthNavigator]="true"
                                      dateFormat="dd/mm/yy "    
                                      [disabled]="readonly"
                                     
                                      > 
                                     </p-calendar>-->

                                       
                                    </ng-template>
                                    <ng-template pTemplate="output">
                                        {{rowData.dat_regl | date : 'dd/MM/y'}}
                                    </ng-template>
                                </p-cellEditor>
                            </td>  
                            <td style="position: center; width: 6%;">
                             
                                            <button *ngIf="!editing && rowData.regle ==='O'&& rowData.recu ==='N' " pButton type="button" pInitEditableRow icon="pi pi-pencil" class="ui-button-info" [disabled]="disable" (click)="onRowEditInit(rowData)" ></button>
                                            <button *ngIf="editing && this.recu[0] === true"   pButton type="button"  pSaveEditableRow icon="pi pi-check" class="ui-button-success"  id="sav" style="margin-right: .5em" (click)="onRowEditSave(rowData,$event)"></button>
                                            <button *ngIf="editing" pButton type="button" pCancelEditableRow icon="pi pi-times" class="ui-button-danger" (click)="onRowEditCancel(rowData, ri)"></button>
                           
                                            
                                           
                                            
                           
                                          </td>
                                    </tr>
                                </ng-template>
                            </p-table>
                            
                          
                              </div>

                              </div>

                             
                    
</div>
</div>
<br>
<div class="row">
  <div class="col-md-11"></div>
 
    <div class="col-md-1" ></div> 
  </div>







<br>
<div class="row">
  
     <div class="col-md-2" *ngIf="btnNouvelleSaise"><p-button class="center"  (click)="nouvelleSaisie()"label="Nouvelle saisie" styleClass="ui-button-info" ></p-button></div>
     <div class="col-md-3"></div>
     <div class="col-md-1" *ngIf="appercu"><p-button class="center"  (click)="apercu()"label="Aperçu" styleClass="ui-button-info" ></p-button></div>
     <div class="col-md-5"></div>  
     <div class="col-md-1" ></div> 
  </div>

</div>



<p-overlayPanel [dismissable]="false"  #op appendTo="body" [showCloseIcon]="true" [style]="{'text-align': 'center','font-size':'14px' ,'background-color': '#f8b7bd'}" >
  <span>{{ msgerror}}  </span> 
</p-overlayPanel>



<p-confirmDialog [style]="{width: '50vw'}"></p-confirmDialog>



